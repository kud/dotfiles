#! /usr/bin/env zsh

source $MY/core/helper

# define cask application folder
export HOMEBREW_CASK_OPTS=--appdir=/Applications

# install brew if needed
if ! type "brew" > /dev/null; then
  echo_space
  echo_title_install "homebrew"
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

# install zsh via brew if needed
if ! type "/usr/local/bin/zsh" > /dev/null; then
  echo_space
  echo_title_install "zsh"
  brewinstall zsh
  echo "/usr/local/bin/zsh" | sudo tee -a /etc/shells
  chsh -s /usr/local/bin/zsh $USER
  # sudo mv /etc/{zshenv,zprofile}
fi

# install bash via brew if needed
if ! type "/usr/local/bin/bash" > /dev/null; then
  echo_space
  echo_title_install "bash"
  brewinstall bash
  echo "/usr/local/bin/bash" | sudo tee -a /etc/shells
fi

# update/upgrade brew
echo_space
echo_title_update "brew"
brew update && brew upgrade && brew cask upgrade
# brew cask update # not needed anymore

# install brew packages
echo_space
echo_title_install "brew packages"

## tap
brewtap homebrew/dupes
brewtap homebrew/versions
# brewtap homebrew/php
brewtap caskroom/cask
brewtap caskroom/fonts
brewtap caskroom/versions
# brewtap docmunch/pdftk
# brewtap aredridel/iojs

## system
brewinstall ssh-copy-id
brewinstall make
brewinstall archey # system information
brewinstall mitmproxy
brewinstall pv
brewinstall md5sha1sum
brewinstall tree
brewinstall ncdu
# brewinstall htop-osx
brewinstall iftop
brewinstall pwgen
brewinstall exiftool
brewinstall grep
brewinstall pcre2
brewinstall htmlcompressor
brewinstall mozjpeg
brewinstall gifsicle
brewinstall ffmpeg --with-libass --with-fontconfig
brewinstall rename
brewinstall exa # Modern replacement for 'ls' — https://the.exa.website
brewinstall less # because the macOS built-in version is old
# brewinstall terminal-notifier
brewinstall p7zip

## network
brewinstall rsync
brewinstall wget
brewinstall curl
brewinstall lsof
brewinstall tcpflow # analyse tcp requests
brewinstall mtr
brewinstall dnsmasq

## zsh
### already in prezto, unneeded
# brewinstall zsh-syntax-highlighting
# brewinstall zsh-completions
# brewinstall zsh-history-substring-search

## git
brewinstall git
brewinstall ghi
brewinstall tig
brewinstall hub

## editors
brewinstall vim

## languages
brewinstall ruby
# brewinstall python # installed via pyenv
brewinstall node
# brewinstall watchman
brewinstall flow

## communication
# brewinstall bitlbee # bridges for irc

## sync/backup
brewinstall syncthing

## others
brewinstall heroku
brewinstall youtube-dl
brewinstall pdf-redact-tools
brewinstall imagemagick --with-fontconfig
brewinstall mas # Mac App Store command line interface - https://github.com/mas-cli/mas
# brewinstall pdftk

echo_space
echo_title "Cleaning brew..."
brew cleanup

# install apps
echo_space
echo_title_install "apps"

# caskinstall dropbox
# if [ ! -d "$HOME/Dropbox" ]; then
#   read \?"Configure now your dropbox and press [Enter] when you've finished..."
# fi

caskinstall sync
if [ ! -d "$HOME/Sync" ]; then
  read \?"Configure now your sync and press [Enter] when you've finished..."
fi

caskinstall java # sorry my love :(
# caskinstall alfred
caskinstall flux
# caskinstall iterm2
# caskinstall iterm2-nightly
caskinstall iterm2-beta
caskinstall appcleaner
caskinstall keepassx
caskinstall spectacle
caskinstall grandperspective
caskinstall cloudup
caskinstall xquartz
caskinstall flash-player
caskinstall qlcolorcode
caskinstall qlstephen
caskinstall qlmarkdown
caskinstall quicklook-json
caskinstall quicklook-csv
caskinstall prefs-editor
caskinstall qlprettypatch
caskinstall betterzipql
caskinstall suspicious-package
caskinstall android-file-transfer
caskinstall licecap
caskinstall etrecheck
caskinstall monodraw
caskinstall skitch # https://evernote.com/skitch/
caskinstall flashlight
caskinstall github-desktop
caskinstall gitkraken
caskinstall xrg
caskinstall molotov
caskinstall insomnia # REST Client — https://insomnia.rest/
caskinstall font-ubuntu
caskinstall font-ubuntu-mono-derivative-powerline
caskinstall font-fira-code
# caskinstall sublime-text3
caskinstall sublime-text-dev
if ! type "subl" > /dev/null; then
  ln -s /Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl /usr/local/bin/subl
fi
caskinstall firefox-nightly
caskinstall atom
caskinstall limechat
caskinstall discord
caskinstall deluge
caskinstall imagealpha
caskinstall imageoptim
caskinstall mysimbl
caskinstall spotify
caskinstall steam
caskinstall kodi
# caskinstall vlc
caskinstall vlc-nightly

source $MY/profiles/$OS_PROFILE/core/brew 2> /dev/null

echo_space
echo_title "Cleaning brew cask..."
brew cask cleanup

